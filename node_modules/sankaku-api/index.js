var request = require('request');
const STUFF = require('./src/stuff');

class API{
 constructor(tag){
    this.tag = tag.replace(/ /g,"_");
 }

 search () {
 	return new Promise((resolve, reject) => {
     function callback(error, response, body) {
         if (!error && response.statusCode == 200) {
            resolve(JSON.parse(body));
         }
     }
 		var options = {
 		    url: `https://capi-v2.sankakucomplex.com/posts/keyset?limit=40&tags=${this.tag}`,
 		    headers: STUFF.HEADERS
 		};
 		request(options, callback);
 	});
 };


 nextPage(next) {
 	return new Promise((resolve, reject) => {
 		function callback(error, response, body) {
 				if (!error && response.statusCode == 200) {
 					 resolve(JSON.parse(body));
 				}
 		}
 		var options = {
     	url: `https://capi-v2.sankakucomplex.com/posts/keyset?lang=en&next=${next}&limit=40&tags=${this.tag}`,
     	headers: STUFF.HEADERS
 	};
 	request(options, callback);
 	})
 }


}

module.exports = API;
